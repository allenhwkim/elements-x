<div class="medium-article"><style>
          figure { margin: 16px 0;}
          img {max-width: 100%; max-height: 100%;}
          .layout-1 { max-width: 680px; }
          .layout-3 { max-width: 1192px; }
          .layout-5 { width: 100%; }
          .layout-6 { width: 30%;}
          .layout-7 { width: 30%;}</style>
<h1 class="title">Start Angular Library with Jest In 5 minutes</h1>
<blockquote><i>‚òù The Jest setup described in this article is tested with Angular CLI 9</i></blockquote>
<div style="display:flex; flex-wrap: wrap"><figure class="layout-1"><img src="https://cdn-images-1.medium.com/max/700/0*TxWHwZ_DevNspPoW.jpg" /><figcaption></figcaption></figure></div>
<p>You like Angular and you also like Jest? However Angular CLI comes with Karma and Jasmine. This article provides bash shell commands to convert Angular projects from Angular/Karma to Angular/Jest in 5 minutes.</p>
<p>Here are the steps.</p>
<div class="list number">Initialize the library</div>
<div class="list number">Uninstall Karma / Protractor / Jasmine</div>
<div class="list number">Install Jest and create jest.setup.ts / jest.config.js</div>
<div class="list number">Update tsconfig.spec.json</div>
<div class="list number">Last, remove src/test.ts and usages</div>
<h2>1. Initialize the library</h2>
<pre>$ ng new <b>my-lib</b> --create-application=false<br/>$ cd <b>my-lib</b><br/>$ ng generate library <b>my-lib<br/></b>$ ng generate application <b>my-lib-demo</b></pre>
<pre>$ ng build <b>my-lib</b> # Check if build good<b><br/></b>$ ng build <b>my-lib-demo </b># Check if build good</pre>
<h2>2. Uninstall Karma / Protractor / Jasmine</h2>
<pre>$ npm uninstall --save-dev \<br/>  karma karma-chrome-launcher \<br/>  karma-coverage-istanbul-reporter \<br/>  karma-jasmine karma-jasmine-html-reporter \<br/>  protractor \<br/>  jasmine-core \<br/>  jamine-spec-reporter \<br/>  @types/jasminewd2 \<br/>  @types/jasmine \<br/>  jasmine-spec-reporter --save-dev</pre>
<pre>$ rm -rf \<br/>  projects/<b>my-lib-demo</b>/karma.conf.js \<br/>  projects/<b>my-lib-demo</b>/e2e \<br/>  projects/<b>my-lib</b>/karma.conf.js</pre>
<h2>3. Install Jest and create jest.setup.ts / jest.config.js</h2>
<p>Jest requires <span class="quote">jest.config.ts</span>.</p>
<pre>$ npm install -D @types/jest jest jest-preset-angular ts-jest</pre>
<pre>$ echo "<i>import </i>'jest-preset-angular';" > jest.setup.ts<br/>$ contents="<i>module</i>.exports = <i>{<br/>  </i>preset: 'jest-preset-angular',<br/>  setupFilesAfterEnv: <i>[</i>'<i><</i>rootDir<i>></i>/../../jest.setup.ts'<i>]<br/>}</i>;";<br/>$ echo "$contents" > projects/<b>my-lib</b>/jest.config.js<br/>$ echo "$contents" > projects/<b>my-lib-demo</b>/jest.config.js</pre>
<h2>4. Update tsconfig.spec.json</h2>
<p>Add <span class="quote">esModuleInterop</span> and <span class="quote">emitDecoratorMetadata</span> as true.</p>
<pre>$ vi projects/<b>my-lib</b>/tsconfig.spec.json projects/<b>my-lib-demo</b>/tsconfig.spec.json</pre>
<pre>{<br/>  "extends": "../../tsconfig.json",<br/>  "compilerOptions": {<br/>    "outDir": "../../out-tsc/spec",<br/>    "types": [ "jest", "node" ],<br/>    "esModuleInterop": true,<br/>    "emitDecoratorMetadata": true<br/>  },<br/>  ...<br/>}</pre>
<h2>5. Last, remove src/test.ts and usages</h2>
<p><span class="quote">src/test.ts</span> is never used with Jest.</p>
<pre>$ rm projects/<b>my-lib-demo</b>/src/test.ts projects/<b>my-lib</b>/src/test.ts<br/>$ vi projects/<b>my-lib-demo</b>/tsconfig.spec.json projects/<b>my-lib</b>/tsconfig.spec.json projects/<b>my-lib</b>/tsconfig.lib.json angular.json</pre>
<p><b>All Done!!!!!!</b>. Now let‚Äôs run the test with Jest command.</p>
<pre>$ npx jest --config projects/<b>my-lib</b>/jest.config.js<br/>$ npx jest --config projects/<b>my-lib-demo</b>/jest.config.js</pre>
<div style="display:flex; flex-wrap: wrap"><figure class="layout-1"><img src="https://cdn-images-1.medium.com/max/700/1*44c1jA5gKUxKk2amVDDPdg.png" /><figcaption></figcaption></figure></div>
<p>Happy coding :)</p>
<p>Do you like Angular? You may find some useful articles for your daily development at <a href="https://medium.com/@allenhwkim/angular-random-how-tos-61be27cac0a2">Angular Random How-Tos</a>.</p>
<p><b>Do you think this useful? If so please;<br/>*</b> <b>Clap üëè button </b>belowÔ∏è to let others to see this too.<br/>* <a href="https://twitter.com/allenhwkim">Follow Allen on Twitter (@allenhwkim)</a></p>
<h2>References</h2>
<div class="list number"><a href="https://angular.io/guide/creating-libraries">https://angular.io/guide/creating-libraries</a></div>
<div class="list number"><a href="https://medium.com/angular-in-depth/migrate-your-angular-library-to-jest-faba9579591a">https://medium.com/angular-in-depth/migrate-your-angular-library-to-jest-faba9579591a</a></div></div>