<div class="medium-article"><style>
          figure { margin: 16px 0;}
          img {max-width: 100%; max-height: 100%;}
          .layout-1 { max-width: 680px; }
          .layout-3 { max-width: 1192px; }
          .layout-5 { width: 100%; }
          .layout-6 { width: 30%;}
          .layout-7 { width: 30%;}</style>
<h1 class="title">Angular: Build A Dropdown Menu</h1>
<h2 class="subtitle">HTML-first/Minimal Javascript/Accessibility-In-Mind</h2>
<h1>Requirements</h1>
<div class="list bulletin">Must be able to navigate with keyboard <span class="quote">Tab/Shift-Tab/Left/Right/Up/Down</span></div>
<div class="list bulletin">Must open a sub menu keyboard <span class="quote">Enter/Space/Down</span></div>
<div class="list bulletin">Must execute a menu item with keyboard <span class="quote">Enter</span> and click</div>
<div class="list bulletin">Must close menu with keyboard<span class="quote">Esc</span></div>
<div class="list bulletin">Must disable menu item with <span class="quote">disabled</span> attribute</div>
<div class="list bulletin">Must be accessibility-compliant with attributes, <span class="quote">role/aria-haspopup/aria-expanded/tabindex</span></div>
<div class="list bulletin">Must pre-select a menu item with id when initialized</div>
<div class="list bulletin">Must open submenu when mouse is over a menu item</div>
<div style="display:flex; flex-wrap: wrap"><figure class="layout-6"><img src="https://cdn-images-1.medium.com/max/700/1*496XE6L4Dfk2lpvbY7WXfQ.png" /><figcaption></figcaption></figure><figure class="layout-7"><img src="https://cdn-images-1.medium.com/max/700/1*0ZM5ZqvL3nWR59DBBZlbkA.png" /><figcaption></figcaption></figure><figure class="layout-7"><img src="https://cdn-images-1.medium.com/max/700/1*904WCsJ6KqYVKZCF9bbLbg.png" /><figcaption>Standard HTML ‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶Angular User HTML‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶.‚Ä¶.. ‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶Angular User HTML after initialized‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶..</figcaption></figure></div>
<h1>HTML</h1>
<p>This guide will use <span class="quote">ul</span> <span class="quote">li</span> as html elements and it‚Äôs going to be styled like dropdown menu.</p>
<div style="display:flex; flex-wrap: wrap"><figure class="layout-6"><img src="https://cdn-images-1.medium.com/max/700/1*q_5WCToRbNbU90VD2Ej53A.png" /><figcaption></figcaption></figure><figure class="layout-7"><img src="https://cdn-images-1.medium.com/max/700/1*kyXnVP-EbiNXGUtubZ7H_A.png" /><figcaption></figcaption></figure><figure class="layout-7"><img src="https://cdn-images-1.medium.com/max/700/1*BNaqPiMoSwUCtf8BEPCO_w.png" /><figcaption></figcaption></figure></div>
<h1>Javascript Development Steps</h1>
<p>There are two main things to do with angular; setting attributes and event listeners.</p>
<h2>Step 1: Set Attributes</h2>
<div class="list bulletin"><span class="quote">role="menuitem‚Äù</span> <span class="quote">role="menubar"</span></div>
<div class="list bulletin"><span class="quote">tabindex="0"</span> <span class="quote">tabindex="-1"</span></div>
<div class="list bulletin"><span class="quote">aria-expanded="false"</span></div>
<h2>Step 2: Set event listeners to all menu items</h2>
<div class="list bulletin">focus: set <span class="quote">aria-expanded=‚Äùtrue"</span> attribute</div>
<div class="list bulletin">click: toggle <span class="quote">aria-expanded</span> attribute with value of <span class="quote">true</span> or <span class="quote">false</span></div>
<div class="list bulletin">keydown: enable navigation or click</div>
<div class="list bulletin">click: select menu item</div>
<h2>Step 3: Enable to select a menu item</h2>
<h1>JavaScript Code</h1>
<h2>Step 1: Set Attributes</h2>
<p>It will set following attributes; <span class="quote">tabindex</span>, <span class="quote">aria-haspopup</span>, <span class="quote">aria-expanded</span>, <span class="quote">role</span>, and these attributes will be used for styling and coding.</p>
<pre>setMenuAttributes(ulEl) {<br/>  !ulEl.getAttribute('role') && ulEl.setAttribute('role', 'menu');<br/>  Array.from(ulEl.querySelectorAll('li'))<br/>    .forEach( (liEl: HTMLElement) => {<br/>      const disabled = liEl.getAttribute('disabled') !== null; <br/>      liEl.setAttribute('tabindex', disabled ? '-1': '0');<br/>      liEl.setAttribute('role', 'menuitem');<br/>      const subMenuEl = liEl.querySelector('ul');<br/>      if (subMenuEl) { // if has submenu<br/>        liEl.setAttribute('aria-haspopup', 'true');<br/>        liEl.setAttribute('aria-expanded', 'false');<br/>        this.setMenuAttributes(subMenuEl);<br/>      }<br/>    });<br/>}</pre>
<h2>Step 2: Set event listeners</h2>
<p>It will set event listeners for all <span class="quote">li</span> menu items to listen to <span class="quote">keydown</span> event and mouse events; <span class="quote">focus</span>, <span class="quote">blur</span>, <span class="quote">click</span>.</p>
<pre>setMenuEventListeners(ulEl) {<br/>  Array.from(ulEl.querySelectorAll('li'))<br/>    .forEach( (liEl: HTMLElement) => {<br/>      liEl.addEventListener('keydown', this.keyHandler.bind(this));<br/>      liEl.addEventListener('focus', this.focusHandler.bind(this));<br/>      liEl.addEventListener('blur', this.blurHandler.bind(this));<br/>      liEl.addEventListener('click', this.clickHandler.bind(this));<br/>   });<br/>}</pre>
<p><b>Keyboard Event Listeners</b></p>
<pre>keyHandler(event: any) {<br/>    switch(event.code) {<br/>      case 'Escape': ... // close menu<br/>      case 'Enter':  ... // open sub menu, or execute<br/>      case 'Space': ... // open sub menu, or execute<br/>      case 'ArrowUp': ... // close submenu or move<br/>      case 'ArrowLeft': ... // move<br/>      case 'ArrowDown': .. // open sub menu or move<br/>      case 'ArrowRight': ... // move to next<br/>    }<br/>    event.stopPropagation();<br/>  }</pre>
<p><b>Mouse Event Listeners</b></p>
<pre>focusHandler(event) {<br/>  // change aria-haspopup attribute value to true/false<br/>  event.stopPropagation();<br/>}</pre>
<pre>blurHandler(event) {<br/>  // change aria-expanded attribute value to true/false <br/>  event.stopPropagation();<br/>}</pre>
<pre>clickHandler(event) {<br/>  // fire menu selected event<br/>  // set class `selected` to a menu item<br/>  event.stopPropagation();<br/>}</pre>
<h2>Step 3: Enable pre-select menu</h2>
<p>This will allow menu to pre-select an item when application is initialized or url is changed.</p>
<pre>if (this.selectedId) {<br/>  const menuItem =<br/>    this.elRef.nativeElement.querySelector('#'+this.selectedId);<br/>  this.doSelectMenuItem(menuItem);<br/>}</pre>
<h1>Styles</h1>
<p>Things to remember for styling</p>
<div class="list bulletin">Remove default <span class="quote">ul</span>, <span class="quote">li</span> style</div>
<div class="list bulletin">Hide submenu items</div>
<div class="list bulletin">Show submenu items when selected</div>
<pre>ul { /* disable original style */<br/>  margin: 0;<br/>  padding: 0;<br/>  list-style: none;<br/>  display: flex;<br/>  background: #FFF;<br/>  position: relative;<br/>  border: 1px solid #ccc;<br/>}</pre>
<pre>li > ul {  <br/>  display: none; /* hide submenu */<br/>}<br/>li[aria-expanded=true] > ul,<br/>li:hover > ul {  /* show submenu when hover or focused */<br/>  display: flex;<br/>  position: absolute;<br/>  flex-flow: column;<br/>  top: 100%;<br/>}</pre>
<div style="display:flex; flex-wrap: wrap"><figure class="layout-3"><iframe src="https://cdn.embedly.com/widgets/media.html?src=https%3A%2F%2Fstackblitz.com%2Fedit%2Fangular-dropdown-menu%3Fembed%3D1%26file%3Dsrc%252Fapp%252Fapp.component.html&display_name=StackBlitz&url=https%3A%2F%2Fstackblitz.com%2Fedit%2Fangular-dropdown-menu%3Ffile%3Dsrc%252Fapp%252Fapp.component.html&key=a19fcc184b9711e1b4764040d3dc5c07&type=text%2Fhtml&schema=stackblitz" width="745" height="400"></iframe><figcaption></figcaption></figure></div>
<p>The working example can be found at <a href="https://stackblitz.com/edit/angular-dropdown-menu">https://stackblitz.com/edit/angular-dropdown-menu</a>.</p>
<h2>References:</h2>
<div class="list bulletin"><a href="https://www.w3.org/WAI/tutorials/menus/application-menus-code/">https://www.w3.org/WAI/tutorials/menus/application-menus-code/</a></div>
<p>Happy coding :)</p>
<p>Allen Kim</p>
<p>This article is a part of <a href="https://medium.com/@allenhwkim/angular-random-how-tos-61be27cac0a2">Angular Random How-Tos</a>. You may find some useful articles for your daily development.</p>
<p><b>Do you think this useful? If so please;<br/>*</b> <b>Clap üëè button </b>belowÔ∏è to let others to see this too.<br/>* <a href="https://twitter.com/allenhwkim">Follow Allen on Twitter (@allenhwkim)</a></p></div>