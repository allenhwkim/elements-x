<h2>CSS to Formatted</h2>

<script>
  function setAceEditor(selector, value, options) {
    const editor = ace.edit(document.querySelector(selector));
    editor.$blockScrolling = Infinity;
    editor.clearSelection();
    editor.resize()
    const defaultOptions = { useWorker: false, wrap: 65, maxLines: 25 }
    value && editor.setValue(value);
    editor.setOptions({...defaultOptions, ...options});
    return editor;
  }

  function formatted(str) {
    try {
      return prettier.format(str, {parser: 'css', plugins: prettierPlugins});
    } catch(e) {
      return str;
    }
  }

  setTimeout( _ => {
    const leftEditor = setAceEditor('#left');
    const rightEditor = setAceEditor('#right');
    const example = document.querySelector('#example').innerText.trim();
    leftEditor.getSession().setValue(example);
    rightEditor.getSession().setValue(formatted(example));
    leftEditor.getSession().on('change', function() {
      const value = leftEditor.getSession().getValue();
      rightEditor.session.setValue(formatted(value));
    });
  })
</script>

<script type="text/html" id="example">
  @media (max-width: 480px) { .bd-examples {margin-right: -.75rem;margin-left: -.75rem } 
  .bd-examples>  { padding-right: .75rem; padding-left: .75rem; }
  }
</script>

<div class="editor-title">
  <span>CSS</span>
  <span>Formatted</span>
</div>
<div class="editor">
  <div class="editor-container">
    <textarea id="left" class="left"></textarea>
  </div>
  <div class="editor-container">
    <textarea id="right" class="right"></textarea>
  </div>
</div>

<style>
  .editor-title, .editor {
    display: flex;
  }
  .editor-title > * {
    width: 50%;
    background: #CCC;
    padding: 4px 8px;
    border-bottom: 2px solid #666;
  }
  .editor-title > *:last-child {
    border-left: 1px solid #666;
  }
  .editor > .editor-container {
    height: calc(100vh - 260px);
    position: relative;
    width: 50%;
    border: 1px solid #ccc;
  }
  .editor > .editor-container > * {
    margin: 0;
  }
</style>
