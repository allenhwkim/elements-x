<div class="medium-article"><style>
          figure { margin: 16px 0;}
          img {max-width: 100%; max-height: 100%;}
          .layout-1 { max-width: 680px; }
          .layout-3 { max-width: 1192px; }
          .layout-5 { width: 100%; }
          .layout-6 { width: 30%;}
          .layout-7 { width: 30%;}</style>
<h1 class="title">Ava, The Test Tool That Works</h1>
<p>If you have written Javascript tests, you already know the pain. It’s too much to learn, too many things to follow; <a href="https://mochajs.org/">Mocha</a>, <a href="https://jasmine.github.io/">Jasmine</a>, <a href="https://github.com/substack/tape">tape</a>, Karma, and more. Ava seems different. It seems very minimal, simple, but capable of doing all kind of tests; browser, mock, coverage, or any.</p>
<p>In addition, it runs test in parallel by default, which means your test will run faster than ever.</p>
<div class="list number">Install ava, a test tool</div>
<pre>$ npm install ava --save-dev</pre>
<p>2. Write your test `my-test.spec.js`</p>
<pre>import test from 'ava';         // this is ES6 syntax :)</pre>
<pre>test(‘test 1’, t => t.pass()}); // arrow function?, works!!</pre>
<p>3. Run test</p>
<pre>$ ava my-test.spec.js</pre>
<p>It’s that simple unlike others; jasmine, karma, mocha, .. etc.</p>
<p>Of course, there are more to learn to master your tests. For more to learn;</p>
<div class="list bulletin"><a href="#8b34">ES6 Source Code Support</a></div>
<div class="list bulletin"><a href="#7654">Browser Support</a></div>
<div class="list bulletin"><a href="#fbba">Simple Reporting</a></div>
<div class="list bulletin"><a href="#9f5a">Assertions</a></div>
<div class="list bulletin"><a href="#fee8">Mock/Stub</a></div>
<h1>ES6 Source Test</h1>
<p><b>SyntaxError: Unexpected token export</b></p>
<a href="https://github.com/avajs/ava/blob/master/docs/recipes/babelrc.md#transpiling-tests-and-sources-the-same-way">https://github.com/avajs/ava/blob/master/docs/recipes/babelrc.md#transpiling-tests-and-sources-the-same-way</a>
<p><a href="https://github.com/avajs/ava/blob/master/docs/recipes/babelrc.md">https://github.com/avajs/ava/blob/master/docs/recipes/babelrc.md</a>#transpiling-sources</p>
<pre>$ npm install babel-register — save-dev</pre>
<p>package.json</p>
<pre>{<br/>...<br/>"ava": {<br/>    "files": [<br/>      "src/**/*.spec.js"<br/>    ],<br/>    "require": [<br/>      "babel-register"  // automatically compile files on the fly<br/>    ],<br/>    "inherit": true,    // inherit source file transpile config<br/>    "verbose": true     // enable the verbose reporter<br/>  }<br/>}</pre>
<p>Run ES6 source code with <span class="quote">ava</span></p>
<pre>$ ava</pre>
<h1>Browser Support</h1>
<p><b>ReferenceError: document is not defined</b></p>
<p><a href="https://github.com/avajs/ava/blob/master/docs/recipes/browser-testing.md#install-browser-env">https://github.com/avajs/ava/blob/master/docs/recipes/browser-testing.md#install-browser-env</a></p>
<p>To resolve, this, you need to install <a href="https://github.com/lukechilds/browser-env">browser-env</a> to simulates a global browser environment using jsdom.</p>
<pre>$ npm install --save-dev browser-env</pre>
<p>test/helpers/setup-browser-env.js</p>
<pre>import browserEnv from ‘browser-env’;<br/>browserEnv([‘window’, ‘document’, ‘navigator’]);</pre>
<p>package.json</p>
<pre>"ava": {<br/>  "files": [<br/>    "src/**/*.spec.js"<br/>  ],<br/>  "require": [<br/>    "babel-register",<br/>    "./test/helpers/setup-browser-env.js"<br/>  ],<br/>  "inherit": true<br/>}</pre>
<h1>Simple Reporting</h1>
<p>By simply adding <span class="quote">verbose</span> as true into your package.json like the <a href="#6f25">above</a>, you can see the full test results.</p>
<p><a href="https://github.com/avajs/ava#reporters">https://github.com/avajs/ava#reporters</a></p>
<pre>"ava": {<br/>    ...<br/>    "verbose": true     // enable the verbose reporter<br/>  }<br/>}</pre>
<pre>✔ singleton test</pre>
<pre>✔ bar</pre>
<pre>2 tests passed [18:31:53]</pre>
<h1>Assertions</h1>
<p><a href="https://github.com/avajs/ava-assert">https://github.com/avajs/ava-assert</a></p>
<p><b>.pass() </b>Passing assertion.<br/><b>.fail() </b>Failing assertion.<br/><b>.truthy(value) </b>Assert that value is truthy.<br/><b>.falsy(value) </b>Assert that value is falsy.<br/><b>.true(value) </b>Assert that value is true.<br/><b>.false(value)</b> Assert that value is false.<br/><b>.is(value, expected) </b>Assert that value is equal to expected.<br/><b>.not(value, expected) </b>Assert that value is not equal to expected.<br/><b>.deepEqual(value, expected) </b>Assert that value is deep equal to expected.<br/><b>.notDeepEqual(value, expected)</b> Assert that value is not deep equal to expected.<br/><b>.throws(function|promise) </b>Assert that function throws an error<br/><b>.notThrows(function|promise) </b>Assert that function doesn’t throw an error<br/><b>.regex(contents, regex) </b>Assert that contents matches regex.<br/><b>.notRegex(contents, regex) </b>Assert that contents does not match regex.<br/><b>.ifError(error) </b>Assert that error is falsy.</p>
<h1>Mock/Stub</h1>
<p>sinon for rescue!!</p>
<h2>Faking DOM object</h2>
<p>Code</p>
<pre>document.body.getElementsByTagName(‘div’)[0].getAttribute(‘data-example’)</pre>
<p>Test</p>
<pre>var els = sinon.stub(document.body, ‘getElementsByTagName’);<br/>els.withArgs(‘div’).returns([{<br/>  getAttribute: sinon.stub();<br/>}])</pre>
<h2>Faking a function</h2>
<p>Let’s say you have a class which update database when it is instantiated with <span class="quote">new</span>. When you test this, you don’t want to update database, you just want to test the instantiated correctly and make it sure the db update function is called.</p>
<pre>class A {<br/>  constructor() {<br/>    this.updateDatabase(); // You want to fake this<br/>  }<br/>}</pre>
<p>By using <span class="quote">sinon.stub</span> and returning a fake response using <span class="quote">returns</span>, you can make a very simple test.</p>
<pre>let stub = sinon.stub(A.prototype, 'updateDatabase').returns(1);<br/>new A();<br/>t.is(spy.callCount, 1);</pre>
<h1>setTimeout Test</h1>
<p>Asynchronous callback is often used in code. However, testing it is a really pain, but not with <span class="quote">ava </span>by;</p>
<div class="list number">using <span class="quote">test.cb</span></div>
<div class="list number">and, calling <span class="quote">t.end()</span> when test ends.</div>
<p><a href="https://github.com/avajs/ava#callback-support">https://github.com/avajs/ava#callback-support</a></p>
<pre><b>test.cb</b>('setTimeout test', t => {<br/>  setTimeout(() => {<br/>    t.pass();<br/>    <b>t.end();</b><br/>  }, 1000);<br/>});</pre></div>